<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
    
<head>
    <meta charset="UTF-8">
    <title>Student Dashboard</title>
</head>
<body>
    <input type="hidden" th:value="${user.name}" id="userName">
    <input type="hidden" th:value="${studentHashedId}" id="studentHashedId">

    <h1>Welcome, Student <span th:text="${name}"></span></h1>
    <p>Email: <span th:text="${email}"></span></p>

    <h3>Your Classrooms:</h3>

    <ul th:if="${classrooms != null and classrooms.size() > 0}">
        <!-- Iterate over the classrooms and display their details -->
        <li th:each="classroom, status: ${classrooms}" class="classrooms">
            <strong>Class Name:</strong> <span th:text="${classroom.className}"></span><br>
            <strong>Room Number:</strong> <span th:text="${classroom.roomNumber}"></span><br>
            <strong>Join Code:</strong> <span th:text="${classroom.joinCode}"></span><br>
            <input type="hidden" th:value="${classroom.hashedId}" id="hashedCid">
            <input type="hidden" th:value="${name}" id="userName">
            <!-- <strong>Hased id:</strong> <span th:text="${teacherHashedId}"></span><br>
            <strong>Course Hased id:</strong> <span th:text="${classroom.hashedId}"></span><br> -->

            <a th:if="${classroom.isLive}" th:href="@{|/student/${studentHashedId}/courseStart/${classroom.hashedId}}">
                Join today's class
            </a>
        </li>
    </ul>
    <p th:unless="${classrooms != null and classrooms.size() > 0}">You have not joined any classrooms yet.</p>

    <a th:href="@{/student/join(email=${email})}">Join</a>
    <a href="/user/logout">Log out</a>

    <div id="messageArea"></div>
    <div>
        <h1>Live session</h1>
    </div>
    <ul th:if="${classrooms != null and classrooms.size() > 0}" class="live-session" id="live-session">
        <!-- Iterate over the classrooms and display their details -->
        <li th:each="classroom, status: ${classrooms}" th:if="${classroom.isLive}" class="live-class">
            <strong>Class Name:</strong> <span th:text="${classroom.className}"></span><br>
            <strong>Room Number:</strong> <span th:text="${classroom.roomNumber}"></span><br>
            <strong>Join Code:</strong> <span th:text="${classroom.joinCode}"></span><br>
            <input type="hidden" th:value="${classroom.hashedId}" id="hashedCid">
            
            <!-- <strong>Hased id:</strong> <span th:text="${teacherHashedId}"></span><br>
            <strong>Course Hased id:</strong> <span th:text="${classroom.hashedId}"></span><br> -->
            <a th:if="${classroom.isLive}" th:href="@{|/student/${studentHashedId}/courseStart/${classroom.hashedId}}">
                Join today's class
            </a>
        </li>
    </ul>
    <div class="formContainer">
        <h1>Join a classroom</h1>

        <form id="joinRoom" th:action="@{/student/join}" method="post">
            <div class="text">
            </div>
            <input type="roomCode" id="roomCode" name="roomCode" placeholder="Enter your classroom code"  autofocus/>            
            <input type="submit" value="Send" onclick="return validateForm()"/>
        </form>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/sockjs-client/1.5.0/sockjs.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/stomp.js/2.3.3/stomp.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script type="text/javascript" th:src="@{/javascript/student/dashboard.js}"></script>
</body>
    <script>
    function validateForm(event) {
        var isValidEmail = validateEmail();
            
        if (!isValidEmail) {
            event.preventDefault(); // Prevent form submission
            return false;
        }
        // Proceed with other form validations, if any
        return true;
    }
    </script>
</html>
